<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PasteBin Pro - View Paste</title>
    <meta name="description" content="View and share code snippets with beautiful syntax highlighting">
    <link rel="stylesheet" href="/public/style.css">
    <link rel="stylesheet" href="/public/motion-blur.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/tokyo-night-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>

<body>
    <div class="background-gradient"></div>
    <div class="grain-overlay"></div>

    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="logo-icon">
                    <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                        <path
                            d="M8 4L24 4C26.2091 4 28 5.79086 28 8V24C28 26.2091 26.2091 28 24 28H8C5.79086 28 4 26.2091 4 24V8C4 5.79086 5.79086 4 8 4Z"
                            stroke="url(#gradient1)" stroke-width="2" />
                        <path d="M10 12H22M10 16H22M10 20H18" stroke="url(#gradient2)" stroke-width="2"
                            stroke-linecap="round" />
                        <defs>
                            <linearGradient id="gradient1" x1="4" y1="4" x2="28" y2="28">
                                <stop stop-color="#00f5ff" />
                                <stop offset="1" stop-color="#7b42ff" />
                            </linearGradient>
                            <linearGradient id="gradient2" x1="10" y1="12" x2="22" y2="20">
                                <stop stop-color="#ff006e" />
                                <stop offset="1" stop-color="#ffbe0b" />
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
                <div class="logo-text">
                    <h1>PasteBin Pro</h1>
                    <span class="badge">Public View</span>
                </div>
            </div>
            <div class="header-actions">
                <button id="rawBtn" class="btn btn-glass">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M3 3H17M3 7H17M3 11H17M3 15H17" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" />
                    </svg>
                    Raw
                </button>
                <button id="copyBtn" class="btn btn-secondary">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <rect x="7" y="7" width="10" height="10" rx="2" stroke="currentColor" stroke-width="2" />
                        <path d="M13 3H5C3.89543 3 3 3.89543 3 5V13" stroke="currentColor" stroke-width="2" />
                    </svg>
                    Copy
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main id="mainContent">
            <!-- Loading State -->
            <div id="loadingState" class="state-container">
                <div class="loader"></div>
                <p>Loading paste...</p>
            </div>

            <!-- Not Found State -->
            <div id="notFoundState" class="state-container" style="display: none;">
                <div class="error-icon">
                    <svg width="80" height="80" viewBox="0 0 80 80" fill="none">
                        <circle cx="40" cy="40" r="36" stroke="currentColor" stroke-width="3" />
                        <path d="M30 30L50 50M50 30L30 50" stroke="currentColor" stroke-width="3"
                            stroke-linecap="round" />
                    </svg>
                </div>
                <h2>Paste Not Found</h2>
                <p>This paste doesn't exist, has expired, or has been deleted.</p>
            </div>

            <!-- Burned State -->
            <div id="burnedState" class="state-container" style="display: none;">
                <div class="warning-icon">
                    <svg width="80" height="80" viewBox="0 0 80 80" fill="none">
                        <path d="M40 10L65 55H15L40 10Z" stroke="currentColor" stroke-width="3" />
                        <path d="M40 30V42M40 50V52" stroke="currentColor" stroke-width="3" stroke-linecap="round" />
                    </svg>
                </div>
                <h2>Paste Burned</h2>
                <p>This was a "burn after read" paste and has been permanently deleted.</p>
            </div>

            <!-- Paste View -->
            <div id="pasteView" style="display: none;">
                <div class="paste-header">
                    <div class="paste-info">
                        <h2 id="pasteTitle">Loading...</h2>
                        <div class="paste-meta">
                            <span class="language-tag" id="pasteLanguage">plaintext</span>
                            <span class="meta-item">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                    <path
                                        d="M8 2C4 2 1.38 5.69 0.8 8c.58 2.31 3.2 6 7.2 6s6.62-3.69 7.2-6c-.58-2.31-3.2-6-7.2-6zm0 10c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm0-6.4c-1.33 0-2.4 1.07-2.4 2.4s1.07 2.4 2.4 2.4 2.4-1.07 2.4-2.4-1.07-2.4-2.4-2.4z"
                                        fill="currentColor" />
                                </svg>
                                <span id="pasteViews">0 views</span>
                            </span>
                            <span class="meta-item">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                    <path d="M8 14A6 6 0 1 0 8 2a6 6 0 0 0 0 12zm0-7.5v3.75M8 11.25h.008"
                                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
                                </svg>
                                <span id="pasteDate">Just now</span>
                            </span>
                            <span class="meta-item" id="burnNotice" style="display: none;">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                    <path d="M8 2L10 6L14 7L11 10L12 14L8 12L4 14L5 10L2 7L6 6L8 2Z"
                                        fill="currentColor" />
                                </svg>
                                <span>This paste will be deleted after viewing</span>
                            </span>
                        </div>
                    </div>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <div class="code-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                        <div class="code-title" id="codeTitle">code.txt</div>
                        <div class="code-actions">
                            <button id="toggleLineNumbers" class="code-action-btn" title="Toggle line numbers">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                    <path d="M2 4h2M2 8h2M2 12h2M6 4h8M6 8h8M6 12h8" stroke="currentColor"
                                        stroke-width="1.5" stroke-linecap="round" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    <pre id="pasteContentContainer"><code id="pasteContent" class="hljs"></code></pre>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer" id="footer" style="display: none;">
            <p>Created with <span class="gradient-text">PasteBin Pro</span></p>
            <div class="footer-links">
                <a href="#" id="shareBtn">Share</a>
                <a href="#" id="reportBtn">Report</a>
            </div>
        </footer>
    </div>

    <!-- Raw View Modal -->
    <div id="rawModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>Raw Content</h3>
                <button id="closeRawBtn" class="btn-icon">
                    <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                        <path d="M14 4L4 14M4 4L14 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                    </svg>
                </button>
            </div>
            <textarea id="rawContent" class="raw-textarea" readonly></textarea>
            <button id="copyRawBtn" class="btn btn-primary btn-large">Copy Raw Content</button>
        </div>
    </div>

    <!-- Motion Blur Cursor Container -->
    <div id="motion-blur-container"></div>

    <!-- Loading Screen (Shader) -->
    <div id="loading-screen"
        style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 10000; background: #000; display: flex; align-items: center; justify-content: center; pointer-events: none;">
        <div id="loading-info"
            style="color: rgba(255,255,255,0.5); font-family: 'Inter', sans-serif; font-size: 0.9rem; letter-spacing: 1px; text-transform: uppercase;">
            Loading...</div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.20.3/TweenMax.min.js"></script>
    <script src="/public/motion-blur.js"></script>

    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js"
        }
    }
    </script>
    <script type="module">
        import { initLoadingShader } from '/public/loading-shader.js';

        // Initialize shader
        initLoadingShader('loading-screen');

        // Hide loader when content is ready (hooked into existing logic or timeout)
        window.hideLoader = function () {
            const loader = document.getElementById('loading-screen');
            if (loader && !loader.classList.contains('fading')) {
                loader.classList.add('fading');
                // Simple fade out animation
                loader.style.transition = 'opacity 1s ease';
                loader.style.opacity = '0';
                setTimeout(() => loader.remove(), 1000);
            }
        };

        // Fallback if app.js doesn't call it immediately
        setTimeout(window.hideLoader, 2000); 
    </script>

    <!-- Audio Elements -->
    <audio id="bgAudio" loop preload="auto">
        <source src="/public/audio.flac" type="audio/flac">
        <source src="/public/song.flac" type="audio/flac">
        Your browser does not support the audio element.
    </audio>

    <div id="volumeControl" class="volume-control">
        <div id="volumeArrow" class="volume-arrow">
            <span>Turn up the volume</span>
            <svg width="40" height="20" viewBox="0 0 40 20" fill="none">
                <path d="M10 10l20 0m0 0l-5-5m5 5l-5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round" />
            </svg>
        </div>
        <button id="imgVolumeBtn" class="btn-icon volume-btn" title="Toggle Volume">
            <!-- Muted Icon by default -->
            <svg id="iconMuted" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2">
                <path d="M11 5L6 9H2V15H6L11 19V5Z" />
                <line x1="23" y1="9" x2="17" y2="15" />
                <line x1="17" y1="9" x2="23" y2="15" />
            </svg>
            <!-- Sound Icon (hidden) -->
            <svg id="iconSound" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2" style="display: none;">
                <path d="M11 5L6 9H2V15H6L11 19V5Z" />
                <path d="M19.07 4.93C20.98 6.84 20.98 9.95 19.07 11.85" />
                <path d="M15.54 8.46C16.47 9.39 16.47 10.91 15.54 11.84" />
            </svg>
        </button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const audio = document.getElementById('bgAudio');
            const volBtn = document.getElementById('imgVolumeBtn');
            const iconMuted = document.getElementById('iconMuted');
            const iconSound = document.getElementById('iconSound');
            const arrow = document.getElementById('volumeArrow');

            // Set volume extremely low as requested
            audio.volume = 0.02;

            let isPlaying = false;
            let hasInteracted = false;

            function playAudio() {
                if (isPlaying) return;

                audio.play().then(() => {
                    isPlaying = true;
                    updateIcon();

                    // Show arrow briefly then fade
                    arrow.classList.add('visible');
                    setTimeout(() => {
                        arrow.classList.remove('visible');
                    }, 4000);

                }).catch(e => {
                    console.log("Audio play failed (waiting for interaction):", e);
                });
            }

            function toggleAudio() {
                if (audio.paused) {
                    playAudio(); // This will just work because it's in a click handler
                } else {
                    audio.pause();
                    isPlaying = false;
                    updateIcon();
                }
            }

            function updateIcon() {
                if (!audio.paused) {
                    iconMuted.style.display = 'none';
                    iconSound.style.display = 'block';
                    volBtn.classList.add('active-volume');
                } else {
                    iconMuted.style.display = 'block';
                    iconSound.style.display = 'none';
                    volBtn.classList.remove('active-volume');
                }
            }

            // Button Toggle
            volBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                toggleAudio();
            });

            // Global Interaction Listener (One-time auto-start)
            function onGlobalInteraction() {
                if (!hasInteracted && audio.paused) {
                    hasInteracted = true; // Mark as interacted so we don't annoyingly retry if they explicitly paused it later (though this runs once usually)
                    playAudio();
                }
            }

            // Listen to clicks/keys anywhere to start the music
            document.addEventListener('click', onGlobalInteraction);
            document.addEventListener('keydown', onGlobalInteraction);
            document.addEventListener('touchstart', onGlobalInteraction);
        });
    </script>

    <script src="/shared/api.js"></script>
    <script src="/public/app.js"></script>
</body>

</html>